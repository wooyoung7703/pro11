import{d as h,k as d,m as w,a as n,e as l,b as e,f as c,t as a,n as f}from"./index-BtrOmqR2.js";const y={class:"space-y-6"},k={class:"card"},C={class:"flex items-center justify-between mb-4"},E={class:"flex items-center gap-2 text-xs"},S=["disabled"],T=["disabled"],A={key:0,class:"px-2 py-0.5 rounded bg-brand-danger/20 text-brand-danger"},P={key:1,class:"px-2 py-0.5 rounded bg-brand-danger/20 text-brand-danger"},L={key:2,class:"px-2 py-0.5 rounded bg-emerald-600/20 text-emerald-400"},K={key:0,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 text-sm"},O={class:"p-3 bg-neutral-800/40 rounded"},D={class:"p-3 bg-neutral-800/40 rounded"},F={class:"p-3 bg-neutral-800/40 rounded"},I={class:"font-mono"},N={class:"p-3 bg-neutral-800/40 rounded"},j={class:"font-mono"},B={class:"p-3 bg-neutral-800/40 rounded"},M={class:"font-mono"},R={class:"p-3 bg-neutral-800/40 rounded"},W={class:"font-mono"},V={class:"p-3 bg-neutral-800/40 rounded col-span-full md:col-span-2"},X={class:"font-mono"},Y={key:0},z={key:1,class:"text-neutral-500"},H={key:2,class:"ml-2 px-2 py-0.5 rounded bg-amber-600/20 text-amber-400 text-[11px]"},U={key:1,class:"text-neutral-500 text-sm"},J=h({__name:"PromotionAlertSettings",setup(q){const s=d(null),v=d(!1),u=d(null),_=d(!1),i=d(null),r=d(null);async function x(){v.value=!0,u.value=null;try{const o=await fetch("/api/models/promotion/alert/status",{headers:{"X-API-Key":window.API_KEY||"dev-key"}});if(!o.ok)throw new Error("HTTP "+o.status);s.value=await o.json()}catch(o){u.value=o.message||String(o)}finally{v.value=!1}}async function g(){_.value=!0,i.value=null,r.value=null;try{const t=await(await fetch("/api/models/promotion/alert/test",{method:"POST",headers:{"X-API-Key":window.API_KEY||"dev-key"}})).json();r.value=t,t.status!=="ok"&&(i.value=t.error||t.reason||"failed")}catch(o){i.value=o.message||String(o)}finally{_.value=!1}}function p(o){return new Date(o*1e3).toLocaleString()}function b(o){const t=Date.now()/1e3-o;return t<60?t.toFixed(0)+"s ago":t<3600?(t/60).toFixed(1)+"m ago":t<86400?(t/3600).toFixed(1)+"h ago":(t/86400).toFixed(1)+"d ago"}return w(()=>x()),(o,t)=>{var m;return l(),n("div",y,[e("section",k,[e("div",C,[t[0]||(t[0]=e("h1",{class:"text-xl font-semibold"},"Promotion Alert Settings",-1)),e("div",E,[e("button",{class:"btn",disabled:v.value,onClick:x},"새로고침",8,S),e("button",{class:"btn",disabled:_.value||!((m=s.value)!=null&&m.webhook_configured),onClick:g},"테스트 전송",8,T),u.value?(l(),n("span",A,a(u.value),1)):c("",!0),i.value?(l(),n("span",P,"TEST: "+a(i.value),1)):c("",!0),r.value&&r.value.status==="ok"?(l(),n("span",L,"TEST OK ("+a(r.value.code)+")",1)):c("",!0)])]),s.value?(l(),n("div",K,[e("div",O,[t[1]||(t[1]=e("div",{class:"text-neutral-400 text-xs"},"Enabled",-1)),e("div",{class:f(["font-mono",s.value.enabled?"text-emerald-400":"text-neutral-500"])},a(s.value.enabled),3)]),e("div",D,[t[2]||(t[2]=e("div",{class:"text-neutral-400 text-xs"},"Webhook Configured",-1)),e("div",{class:f(["font-mono",s.value.webhook_configured?"text-emerald-400":"text-rose-400"])},a(s.value.webhook_configured),3)]),e("div",F,[t[3]||(t[3]=e("div",{class:"text-neutral-400 text-xs"},"Min Window",-1)),e("div",I,a(s.value.min_window),1)]),e("div",N,[t[4]||(t[4]=e("div",{class:"text-neutral-400 text-xs"},"Low AUC Ratio",-1)),e("div",j,a(s.value.low_auc_ratio),1)]),e("div",B,[t[5]||(t[5]=e("div",{class:"text-neutral-400 text-xs"},"Low ECE Margin Ratio",-1)),e("div",M,a(s.value.low_ece_margin_ratio),1)]),e("div",R,[t[6]||(t[6]=e("div",{class:"text-neutral-400 text-xs"},"Cooldown (s)",-1)),e("div",W,a(s.value.cooldown_seconds),1)]),e("div",V,[t[7]||(t[7]=e("div",{class:"text-neutral-400 text-xs"},"Last Alert",-1)),e("div",X,[s.value.last_alert_ts?(l(),n("span",Y,a(b(s.value.last_alert_ts))+" ("+a(p(s.value.last_alert_ts))+")",1)):(l(),n("span",z,"—")),s.value.in_cooldown?(l(),n("span",H,"COOLDOWN")):c("",!0)])])])):(l(),n("div",U,"No status"))])])}}});export{J as default};
