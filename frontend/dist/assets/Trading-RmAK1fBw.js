import{d as Fl,k as L,l as ot,c as m,m as Cl,o as El,a as v,b as e,f as b,p as I,A as wt,i as N,q as Sl,t as a,n as z,z as $,w as H,s as Nt,h as Ia,F as st,r as at,v as lt,E as Ml,O as Tl,B as za,e as d}from"./index-BtrOmqR2.js";import{u as $l,c as Ll,a as Oa,h as Pl,_ as U,M as V}from"./tradingActivity-C9RmvY8q.js";import Ft from"./http-CilSfrpq.js";import{_ as Bl}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Al={class:"space-y-6"},Dl={class:"card"},Il={class:"flex items-center justify-between mb-2"},zl={class:"flex items-center gap-2 text-[10px]"},Ol=["disabled"],Rl={key:0,class:"inline-block w-3 h-3 rounded-full border-2 border-t-transparent border-brand-accent animate-spin"},ql={class:"flex items-center gap-1 cursor-pointer select-none"},jl={key:1,class:"text-neutral-500"},Hl={key:1,class:"text-xs text-neutral-400 animate-pulse"},Ul={key:2,class:"text-xs text-neutral-400"},Vl={key:3,class:"space-y-3"},Wl={class:"flex items-center gap-2"},Yl={key:0,class:"ml-auto text-[10px] text-neutral-500"},Kl={class:"grid grid-cols-2 md:grid-cols-6 gap-3 text-[11px]"},Gl={class:"mt-3 text-[10px] opacity-70 max-h-48 overflow-auto"},Jl={class:"card space-y-3"},Ql={class:"flex items-start justify-between"},Xl={class:"space-y-1"},Zl={class:"flex items-center gap-2"},tn={key:0,class:"text-[10px] text-neutral-500"},en={class:"flex items-center gap-3 text-[11px]"},sn={class:"flex items-center gap-1 select-none"},an=["checked"],ln=["disabled"],nn={class:"mt-1 flex items-center gap-3 text-[10px] text-neutral-500"},rn={key:0},on={key:1},un={key:0,class:"p-2 rounded border border-neutral-700/60 bg-neutral-800/30 mt-2 text-[11px]"},dn={class:"flex items-center justify-between mb-2"},cn={class:"flex items-center gap-2"},vn={key:0,class:"px-1 py-0.5 rounded border border-emerald-700/60 bg-emerald-900/30 text-emerald-200"},mn={key:1,class:"px-1 py-0.5 rounded border border-neutral-700/60 bg-neutral-900/40 text-neutral-300"},xn={class:"px-1 py-0.5 rounded border border-neutral-600/60 text-neutral-400"},_n={class:"grid grid-cols-1 md:grid-cols-3 gap-2"},pn={class:"p-2 rounded bg-neutral-800/40"},bn={class:"grid grid-cols-2 gap-1"},gn={class:"mt-1 grid grid-cols-2 gap-1 text-[10px] text-neutral-500"},fn={class:"text-right text-neutral-300"},hn={class:"text-right text-neutral-300"},yn={class:"text-right text-neutral-300"},kn={class:"text-right text-neutral-300"},wn={class:"p-2 rounded bg-neutral-800/40"},Nn={class:"grid grid-cols-2 gap-1"},Fn={class:"text-right text-neutral-200"},Cn={class:"text-right text-neutral-200"},En={class:"text-right text-neutral-200"},Sn={class:"p-2 rounded bg-neutral-800/40"},Mn={class:"grid grid-cols-2 gap-1"},Tn={class:"text-right text-neutral-200"},$n={class:"text-right text-neutral-200"},Ln={class:"text-right text-neutral-200"},Pn={class:"mt-1 text-[10px] text-neutral-500"},Bn={key:0,class:"mt-2 flex flex-wrap gap-1"},An={key:1,class:"p-2 rounded border border-neutral-700/60 bg-neutral-800/30 mt-2 text-[11px]"},Dn={class:"flex items-center justify-between mb-2"},In={class:"grid grid-cols-1 md:grid-cols-3 gap-2"},zn={class:"p-2 rounded bg-neutral-800/40"},On={class:"grid grid-cols-2 gap-1"},Rn={class:"text-right text-neutral-200"},qn={class:"mt-1 text-[10px] text-neutral-500"},jn={class:"p-2 rounded bg-neutral-800/40"},Hn={class:"grid grid-cols-2 gap-1"},Un={class:"text-right text-neutral-200"},Vn={class:"text-right text-neutral-200"},Wn={class:"text-right text-neutral-200"},Yn={class:"mt-1 text-[10px] text-neutral-500"},Kn={class:"p-2 rounded bg-neutral-800/40"},Gn={class:"grid grid-cols-2 gap-1"},Jn={class:"text-right text-neutral-200"},Qn={class:"text-right text-neutral-200"},Xn={class:"text-right text-neutral-200"},Zn={class:"mt-1 text-[10px] text-neutral-500"},tr={key:0,class:"mt-2 flex flex-wrap gap-1"},er={class:"grid md:grid-cols-3 gap-3 text-[11px]"},sr={class:"space-y-2"},ar={class:"grid grid-cols-2 gap-2"},lr={class:"flex items-center gap-2"},nr={class:"flex items-center gap-2"},rr={class:"space-y-2"},or={class:"flex items-center justify-between"},ir={class:"text-[10px] text-neutral-500 flex items-center gap-1"},ur={class:"grid grid-cols-1 md:grid-cols-2 gap-2"},dr={class:"p-2 rounded border border-neutral-700/60 bg-neutral-800/30"},cr={class:"flex items-center gap-2 mb-1"},vr={class:"text-[10px] text-neutral-400"},mr={class:"text-neutral-200"},xr={key:0,class:"text-amber-300"},_r={class:"p-2 rounded border border-neutral-700/60 bg-neutral-800/30"},pr={class:"flex items-center gap-2 mb-1"},br={class:"grid grid-cols-3 gap-2 text-[10px] text-neutral-400"},gr={class:"text-neutral-200"},fr={class:"text-neutral-200"},hr={key:0,class:"mt-1 text-[10px] text-amber-300"},yr={key:1,class:"mt-1 text-[10px] text-rose-300"},kr={class:"mt-2 overflow-x-auto"},wr={key:0,class:"text-[10px] text-neutral-500 mb-1"},Nr={class:"text-neutral-300"},Fr={class:"w-full text-[10px] border-collapse"},Cr={class:"p-1"},Er={class:"p-1"},Sr={class:"p-1"},Mr={class:"p-1"},Tr={class:"p-1"},$r={class:"p-1"},Lr={class:"p-1"},Pr={class:"p-1"},Br={class:"p-1"},Ar={class:"space-y-2"},Dr={class:"flex items-center justify-between"},Ir={class:"flex items-center gap-2"},zr={class:"text-[10px] text-neutral-500 flex items-center gap-1"},Or={key:0,class:"grid grid-cols-1 md:grid-cols-6 gap-2 text-[10px] items-center"},Rr={class:"flex items-center gap-2 md:col-span-2"},qr={class:"flex items-center gap-2 md:col-span-2"},jr={class:"flex items-center gap-2"},Hr={class:"flex items-center gap-2"},Ur={class:"flex items-center gap-2 text-[10px] text-neutral-500"},Vr={class:"grid grid-cols-2 md:grid-cols-4 gap-2"},Wr={key:1,class:"text-[10px] text-neutral-500 flex items-center gap-3"},Yr={key:0},Kr={key:1,class:"text-amber-300"},Gr={key:2,class:"text-amber-200"},Jr={key:2,class:"text-[10px] opacity-70"},Qr={key:2,class:"text-[11px] text-amber-200 bg-amber-500/10 border border-amber-500/30 px-2 py-1 rounded"},Xr={class:"text-[10px] opacity-70"},Zr={class:"grid md:grid-cols-2 gap-3 mt-2"},to={class:"p-2 rounded border border-neutral-700/60 bg-neutral-800/30"},eo={class:"flex items-center justify-between mb-2"},so={key:0,class:"text-[10px] text-neutral-500"},ao={key:0,class:"text-[10px] text-neutral-500"},lo={key:1,class:"w-full text-[10px] border-collapse"},no={class:"p-1 text-neutral-300"},ro={class:"p-1 text-right text-neutral-200"},oo={class:"p-1 text-right text-neutral-200"},io={class:"p-2 rounded border border-neutral-700/60 bg-neutral-800/30"},uo={class:"flex items-center justify-between mb-2"},co={class:"text-[10px] text-neutral-500 flex items-center gap-2"},vo={key:0},mo={key:1,class:"px-1 py-0.5 rounded border border-neutral-600/60 text-neutral-400"},xo={key:0,class:"text-[10px] text-neutral-500"},_o={key:1,class:"w-full text-[10px] border-collapse"},po={class:"p-1 text-neutral-300"},bo={class:"p-1 text-neutral-300"},go={class:"p-1 text-right text-neutral-200"},fo={class:"p-1 text-right text-neutral-200"},ho={class:"p-1 text-neutral-300"},yo={key:2,class:"mt-1 text-[10px] text-neutral-500"},ko={key:0,class:"card space-y-3"},wo={class:"flex items-center justify-between"},No={class:"flex items-center gap-2"},Fo={class:"flex items-center gap-3"},Co={key:0,class:"text-[10px] text-neutral-500"},Eo={class:"grid md:grid-cols-3 gap-3 text-[11px]"},So={class:"p-2 rounded border border-neutral-700/60 bg-neutral-800/30"},Mo={class:"grid grid-cols-2 gap-1 text-[10px]"},To={class:"text-neutral-200 text-right"},$o={class:"text-neutral-200 text-right"},Lo={class:"text-neutral-200 text-right"},Po={class:"mt-2 h-2 rounded bg-neutral-700/50 overflow-hidden"},Bo={class:"p-2 rounded border border-neutral-700/60 bg-neutral-800/30"},Ao={class:"flex items-center justify-between mb-2"},Do={class:"grid grid-cols-2 gap-2 text-[10px]"},Io={class:"p-2 rounded bg-neutral-800/60"},zo={class:"text-right text-neutral-200"},Oo={class:"p-2 rounded bg-neutral-800/60"},Ro={class:"text-right text-neutral-200"},qo={class:"mt-2 h-2 rounded bg-neutral-700/50 overflow-hidden"},jo={key:0,class:"mt-2 list-disc list-inside text-[10px] text-neutral-300"},Ho={class:"mt-1 text-[10px] text-neutral-500"},Uo={class:"p-2 rounded border border-neutral-700/60 bg-neutral-800/30"},Vo={class:"overflow-x-auto"},Wo=["viewBox"],Yo=["y2"],Ko=["y1","x2","y2"],Go=["y1","x2"],Jo={class:"text-[8px] fill-neutral-400"},Qo=["x","y"],Xo=["x","y"],Zo=["x","y"],ti=["y"],ei=["x","y"],si=["x","y"],ai={"clip-path":"url(#relClip)"},li=["cx","cy","r","fill"],ni={class:"text-[8px] fill-neutral-400"},ri=["x","y"],oi=["x","y"],ii={key:0,class:"mt-1 text-[10px] text-neutral-500"},ui={class:"md:col-span-3 p-2 rounded border border-neutral-700/60 bg-neutral-800/30"},di={class:"overflow-x-auto"},ci={class:"w-full text-[10px] border-collapse"},vi={class:"text-neutral-400"},mi={key:0},xi={key:0},_i={key:0},pi={key:0},bi={key:0},gi={key:0},fi={key:0},hi={class:"p-1 text-neutral-300"},yi={class:"p-1 text-right text-neutral-200"},ki={class:"p-1 text-right text-neutral-200"},wi={class:"p-1 text-right text-neutral-400"},Ni={class:"p-1 text-right text-neutral-200"},Fi={class:"p-1 text-right text-neutral-200"},Ci={class:"p-1 text-right text-neutral-200"},Ei={class:"p-1 text-right text-neutral-200"},Si={key:0},Ra="calibration_open_state",Mi="ordersSourcePref",qa="ops_hysteresis_delta_pp",It=320,zt=200,y=28,Ti=Fl({__name:"Trading",setup($i){const O=$l(),vt=L(!0),Ct=L(null),E=L("live"),K=L(""),G=L(""),mt=L(1e3),xt=L(""),nt=L((()=>{try{const s=localStorage.getItem(Ra);return s==null?!0:s==="1"}catch{return!0}})());ot(nt,s=>{try{localStorage.setItem(Ra,s?"1":"0")}catch{}});const n=L({loading:!1,saving:!1,enabled:!1,params:{base_size:1,cooldown_sec:60,last_trade_ts:null,allow_scale_in:!0,scale_in_size_ratio:.5,scale_in_max_legs:3,scale_in_min_price_move:0,scale_in_cooldown_sec:0,scale_in_freeze_on_exit:!1,exit_slice_seconds:0},equity:{starting:null,current:null,peak:null,cumulative_pnl:null},positions:[],orders:[],ordersSource:"db"}),Et=m(()=>{var u,c,i;const s=String(((u=n.value.params)==null?void 0:u.fee_mode)||"").toLowerCase(),t=Number(((c=n.value.params)==null?void 0:c.fee_taker)??.001),l=Number(((i=n.value.params)==null?void 0:i.fee_maker)??.001);return s==="maker"?`maker ${(l*100).toFixed(2)}%`:`taker ${(t*100).toFixed(2)}%`}),o=L({loading:!1,data:null}),S=m(()=>O.summary),ja=m(()=>{const s=O.lastDecisionDate;return s?s.toLocaleString():"-"}),Ha=m(()=>{var s;return Ll((s=S.value)!=null&&s.last_decision_ts?Math.max(0,Math.floor(Date.now()/1e3-(S.value.last_decision_ts||0))):null)}),Ua=m(()=>{var s;return Oa(((s=S.value)==null?void 0:s.decisions_1m)??null)}),Va=m(()=>{var s;return Oa(((s=S.value)==null?void 0:s.decisions_5m)??null)}),Wa=m(()=>`${Math.round(O.idleStreakMinutes)}m`),Ya=m(()=>O.idleStreakMinutes>0?"idle":"ok"),Ka=m(()=>O.isIdle?"idle":"active"),Ga=m(()=>O.isIdle?"idle":"ok"),Ot=m(()=>O.compareIntervalWithEnv()),Ja=m(()=>Ot.value.match),Rt=m(()=>{const s=Ot.value;return s.match==null?"":s.match?`backend interval=${s.backend}s (env 일치)`:`backend interval=${s.backend}s, env=${s.env}s (불일치)`}),qt=m(()=>{var s;return Pl((s=S.value)==null?void 0:s.disable_reason)}),Qa=L((()=>{try{const s=localStorage.getItem(Mi);if(s==="exchange"||s==="db")return s}catch{}return"auto"})());function _t(){O.fetchSummary(),vl(Qa.value),el(),E.value==="backtest"&&ft()}const pt=L(null);function jt(){pt.value&&(clearInterval(pt.value),pt.value=null)}function Ht(){var l;if(jt(),!vt.value)return;const s=Number(((l=S.value)==null?void 0:l.interval)??10),t=Math.max(2,isFinite(s)?s:10)*1e3;pt.value=setInterval(()=>{_t()},t)}ot([vt,()=>{var s;return(s=S.value)==null?void 0:s.interval}],()=>{Ht()}),Cl(()=>{if(!K.value&&!G.value){const s=new Date,t=new Date(s.getTime()-720*60*60*1e3);K.value=gt(t),G.value=gt(s)}_t(),Ht()}),El(()=>{jt()});function Xa(){var u,c;const s=n.value.enabled;if((((u=n.value.orders)==null?void 0:u.length)||0)>0)return null;const l=[];if(s||l.push("라이브 트레이딩이 비활성화되어 있습니다. 우측 상단 enable을 켜세요."),(c=n.value.params)!=null&&c.last_trade_ts){const i=Date.now()/1e3-(n.value.params.last_trade_ts||0);i<(n.value.params.cooldown_sec||0)&&l.push(`쿨다운 적용 중 (${Math.ceil(n.value.params.cooldown_sec-i)}초 남음).`)}return l.length?l.join(" "):null}async function Za(s){try{await Ft.post("/api/trading/live/enable",null,{params:{enabled:s}}),n.value.enabled=s}catch{}}function tl(s){const t=s.target;Za(!!t.checked)}async function el(){try{o.value.loading=!0;const t=(await Ft.get("/api/trading/no_signal_breakdown")).data||null;if(t==null)o.value.data=o.value.data||null;else{o.value.data||(o.value.data={});const l=o.value.data;l.live_enabled=t.live_enabled,l.params=t.params,l.cooldown_remaining_sec=t.cooldown_remaining_sec,l.latest_inference=t.latest_inference,l.threshold_config=t.threshold_config,l.threshold_override=t.threshold_override,l.inference_symbol_mismatch=t.inference_symbol_mismatch||t.mismatch_hint,l.risk=t.risk,l.scale_in=t.scale_in}}catch{}finally{o.value.loading=!1}}const q=m(()=>{var l,u,c;const s=(l=o.value.data)==null?void 0:l.threshold_override;if(typeof s=="number"&&isFinite(s))return s;const t=(c=(u=o.value.data)==null?void 0:u.latest_inference)==null?void 0:c.threshold;return typeof t=="number"&&isFinite(t)?t:null}),rt=m(()=>{var t,l;const s=(l=(t=o.value.data)==null?void 0:t.latest_inference)==null?void 0:l.probability;return typeof s=="number"&&isFinite(s)?s:null}),J=m(()=>rt.value==null||q.value==null?null:rt.value-q.value),St=m(()=>J.value==null?!1:Math.abs(J.value)<.02),sl=m(()=>rt.value==null||q.value==null?"데이터 없음":rt.value>=q.value?"통과(권고)":"보류"),al=m(()=>rt.value==null||q.value==null?"idle":(J.value??0)<0?"error":St.value?"warning":"ok"),ll=m(()=>{if(J.value==null)return"-";const s=J.value;return(s>=0?"+":"")+s.toFixed(3)}),nl=m(()=>J.value==null?"text-neutral-200":J.value<0?"text-rose-300":St.value?"text-amber-200":"text-emerald-300"),Ut=m(()=>{var s,t;return((t=(s=o.value.data)==null?void 0:s.latest_inference)==null?void 0:t.symbol)||null}),it=L((()=>{try{const s=Number(localStorage.getItem(qa));return Number.isFinite(s)&&s>=0?s:.02}catch{return .02}})());ot(it,s=>{try{localStorage.setItem(qa,String(s))}catch{}});const rl=m(()=>{const s=q.value;return s==null?"-":s.toFixed(3)}),ol=m(()=>{const s=q.value;if(s==null)return"-";const t=Number.isFinite(it.value)?it.value:.02;return Math.max(0,s-t).toFixed(3)}),il=m(()=>{var t;const s=Number((t=n.value.params)==null?void 0:t.scale_in_size_ratio);return Number.isFinite(s)?`${s.toFixed(2)}x`:"-"}),ul=m(()=>{const s=Number(g.value.sampleCount??0);return s>=1e3?"bg-emerald-900/40 border-emerald-700/60 text-emerald-200":s>=200?"bg-amber-900/20 border-amber-700/50 text-amber-200":"bg-neutral-800/60 border-neutral-700/60 text-neutral-300"}),g=m(()=>{const s=o.value.data||{},t=s.calibration||{},l=s.monitor||{},u=D=>{const j=Number(D);return Number.isFinite(j)?j:null},c=D=>{const j=Number(D);return Number.isFinite(j)?Math.trunc(j):null},i=(D,j=4)=>D==null?"-":D.toFixed(j),_=D=>Math.max(0,Math.min(1,D)),p=u(t.prod_ece??t.production_ece),f=u(t.live_ece),C=f!=null&&p!=null?Math.abs(f-p):u(t.delta_ece??t.delta),x=u(t.live_brier),h=u(t.prod_brier??t.production_brier),k=c(t.sample_count??t.n??s.sample_count??s.n),T=t.window&&(t.window.from_iso||t.window.from)?t.window.from_iso||t.window.from:null,F=t.window&&(t.window.to_iso||t.window.to)?t.window.to_iso||t.window.to:null,w=u(l.abs_threshold)??.05,P=u(l.delta)??C??0,R=`${(_((f??0)/.2)*100).toFixed(1)}%`,tt=`${(_(Math.abs(P)/(w||.05))*100).toFixed(1)}%`,et=Array.isArray(l.reasons)?l.reasons:[],Y=c(l.abs_streak??l.abs_drift_streak),dt=c(l.rel_streak??l.rel_drift_streak),ct=!!l.retrain_recommended||(f??0)>.2||(C??0)>.2;return{show:[p,f,x,h,Y,dt].some(D=>D!=null)||et.length>0||ct,prodECE:i(p),liveECE:i(f),deltaECE:i(C),eceWorse:f!=null&&p!=null?f>p:!1,liveBrier:i(x),prodBrier:i(h),liveECEBarWidth:R,retrainRecommended:ct,absStreak:Y,relStreak:dt,reasons:et,deltaBarWidth:tt,sampleCount:k,winFrom:T,winTo:F}});ot(()=>g.value.retrainRecommended,s=>{s&&(nt.value=!0)},{immediate:!0});const Vt=m(()=>{var _;const s=(_=o.value.data)==null?void 0:_.calibration,t=Array.isArray(s==null?void 0:s.bins)?s.bins:[],l=Number((s==null?void 0:s.sample_count)??0),u=p=>{const f=Number(p);return Number.isFinite(f)?f:0},c=(p,f,C=1.96)=>{if(!Number.isFinite(f)||f<=0)return null;const x=p/f,h=1+C*C/f,k=x+C*C/(2*f),T=C*Math.sqrt((x*(1-x)+C*C/(4*f))/f),F=Math.max(0,(k-T)/h),w=Math.min(1,(k+T)/h);return[F,w]},i=[];for(const p of t){const f=String(p.range??p.bin??"-"),C=u(p.avg??p.confidence??p.conf),x=u(p.acc??p.accuracy??p.rate),h=Math.max(0,Math.trunc(u(p.n??p.count))),k=Math.abs(C-x),T=(l>0?h/l:0)*k,F=c(Math.round(x*h),h);i.push({range:f,conf:C,acc:x,n:h,gap:k,contrib:T,ciLow:F?F[0]:null,ciHigh:F?F[1]:null})}return i}),bt=L("contrib"),B=L("desc");function Q(s){return bt.value===s}function X(s){bt.value===s?B.value=B.value==="asc"?"desc":"asc":(bt.value=s,B.value=s==="range"?"asc":"desc")}const Wt=m(()=>{const s=(Vt.value||[]).slice(),t=s.reduce((i,_)=>i+(Number.isFinite(_.contrib)?_.contrib:0),0),l=B.value==="asc"?1:-1,u=bt.value;s.sort((i,_)=>{switch(u){case"range":return String(i.range).localeCompare(String(_.range))*l;case"conf":return(i.conf-_.conf)*l;case"acc":return(i.acc-_.acc)*l;case"gap":return(i.gap-_.gap)*l;case"n":return(i.n-_.n)*l;case"contrib":return(i.contrib-_.contrib)*l;case"ciw":{const p=i.ciLow==null||i.ciHigh==null?B.value==="asc"?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:i.ciHigh-i.ciLow,f=_.ciLow==null||_.ciHigh==null?B.value==="asc"?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:_.ciHigh-_.ciLow;return(p-f)*l}default:return(i.contrib-_.contrib)*l}});let c=0;for(const i of s){const _=t>0?i.contrib/t:0;c+=_,i.contribPct=Number.isFinite(_)?_:0,i.cumPct=Number.isFinite(c)?c:0}return s}),Z=It-y*2,A=zt-y*2,Yt=m(()=>{const s=Vt.value;if(!s.length)return[];const t=Math.max(...s.map(i=>i.n||0),1),l=i=>Math.max(0,Math.min(1,i)),u=i=>{const _=Math.max(0,Math.min(.2,i))/.2,p=Math.round(255*_),f=Math.round(180*(1-_)+80*_);return`rgb(${p}, ${f}, 100)`},c=[];for(const i of s){const _=l(i.conf),p=l(i.acc),f=2+6*Math.sqrt((i.n||0)/t),C=u(Math.abs(i.conf-i.acc)),x=`range: ${i.range}
conf: ${i.conf.toFixed(3)}
acc: ${i.acc.toFixed(3)}
N: ${i.n}
gap: ${Math.abs(i.conf-i.acc).toFixed(3)}`;c.push({x:_,y:p,r:f,color:C,title:x})}return c});async function dl(){const t=["Calibration Report",`Window(UTC): ${g.value.winFrom||"-"} → ${g.value.winTo||"-"}`,`N: ${g.value.sampleCount??"-"}`,`Prod ECE: ${g.value.prodECE}`,`Live ECE: ${g.value.liveECE}`,`Δ ECE: ${g.value.deltaECE}`,`Prod Brier: ${g.value.prodBrier}`,`Live Brier: ${g.value.liveBrier}`,`Abs streak: ${g.value.absStreak??"-"}`,`Rel streak: ${g.value.relStreak??"-"}`,`Reasons: ${(g.value.reasons||[]).join(", ")||"-"}`].join(`
`);try{await navigator.clipboard.writeText(t)}catch{window.prompt("Copy calibration report:",t)}}function gt(s){const t=p=>p<10?`0${p}`:`${p}`,l=s.getFullYear(),u=t(s.getMonth()+1),c=t(s.getDate()),i=t(s.getHours()),_=t(s.getMinutes());return`${l}-${u}-${c}T${i}:${_}`}const W=L({loading:!1,data:null});async function ft(){if(E.value==="backtest")try{W.value.loading=!0;const s={},t=i=>{try{if(!i)return null;const _=i.match(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2})(?::(\d{2}))?$/);if(_){const[C,x,h,k,T,F,w]=_,P=new Date(Number(x),Number(h)-1,Number(k),Number(T),Number(F),w?Number(w):0,0),R=Math.floor(P.getTime()/1e3);return isFinite(R)?R:null}const p=new Date(i),f=Math.floor(p.getTime()/1e3);return isFinite(f)?f:null}catch{return null}},l=t(K.value),u=t(G.value);l!=null&&(s.from_ts=l),u!=null&&(s.to_ts=u),xt.value&&(s.symbol=xt.value.toUpperCase());const c=await Ft.get("/api/backtest/replay",{params:s});W.value.data=c.data||null}catch{}finally{W.value.loading=!1}}function ht(){E.value==="backtest"&&ft()}const Mt=L(null);ot([K,G],()=>{E.value==="backtest"&&(Mt.value&&clearTimeout(Mt.value),Mt.value=setTimeout(()=>ft(),300))}),ot(E,s=>{s==="backtest"&&ft()});const Tt=m(()=>{var s;return((s=W.value.data)==null?void 0:s.summary)||null}),Kt=m(()=>{var s,t;return((t=(s=Tt.value)==null?void 0:s.window)==null?void 0:t.from_iso)||null}),Gt=m(()=>{var s,t;return((t=(s=Tt.value)==null?void 0:s.window)==null?void 0:t.to_iso)||null}),$t=m(()=>{const s=W.value.data,t={trades:[],totalNet:0};if(!s)return t;const l=Array.isArray(s.events)?s.events.filter(x=>x&&x.status==="filled"&&typeof x.size=="number"&&typeof x.price=="number").map(x=>({side:String(x.side).toLowerCase()==="sell"?"sell":"buy",size:Number(x.size),price:Number(x.price),filled_ts_ms:Number(x.filled_ts_ms)||void 0,created_ts_ms:Number(x.created_ts_ms)||void 0})):[];if(l.length===0)return t;l.sort((x,h)=>(x.filled_ts_ms??x.created_ts_ms??0)-(h.filled_ts_ms??h.created_ts_ms??0));const u=(()=>{const x=s.summary||{},h=String(x.fee_mode||"taker").toLowerCase(),k=Number(h==="maker"?x.fee_maker:x.fee_taker);return Number.isFinite(k)&&k>=0?k:.001})(),c=[];let i=0,_=0;const p=(x,h,k,T)=>{const F=k*h*u;c.push({side:x,size:h,price:k,ts_ms:T,fee:F})},f=(x,h,k,T)=>{let F=h;for(;F>0&&c.length>0;){const w=c[0];if(w.side===x)break;const P=Math.min(F,w.size);let R=0;w.side==="buy"&&x==="sell"?R=(k-w.price)*P:w.side==="sell"&&x==="buy"&&(R=(w.price-k)*P);const tt=w.fee*(P/w.size),et=k*P*u,Y=R-tt-et;_+=Y,t.totalNet+=Y,w.size-=P,w.fee-=tt,w.size<=1e-12&&c.shift(),F-=P,i+=(x==="buy"?P:-P)*(i<0?1:i>0?-1:0)}return h-F},C=()=>{let x=0,h=0;for(const k of c)k.side==="buy"?x+=k.size:h+=k.size;i=x-h};for(const x of l){const h=x.filled_ts_ms??x.created_ts_ms??0,k=Math.sign(i);if(x.side==="buy"){const F=f("buy",x.size,x.price),w=x.size-F;w>1e-12&&p("buy",w,x.price,h)}else{const F=f("sell",x.size,x.price),w=x.size-F;w>1e-12&&p("sell",w,x.price,h)}C();const T=Math.sign(i);k!==0&&T===0?(t.trades.push({ts_ms:h,side:k>0?"long":"short",size:0,entry_price:0,exit_price:0,gross_pnl:0,fees:0,net_pnl:_}),_=0):k!==0&&T!==0&&k!==T&&(t.trades.push({ts_ms:h,side:k>0?"long":"short",size:0,entry_price:0,exit_price:0,gross_pnl:0,fees:0,net_pnl:_}),_=0)}return t}),ut=m(()=>{var t;const s=(t=W.value.data)==null?void 0:t.trades;return Array.isArray(s)?s:[]}),Lt=m(()=>ut.value.length>0?ut.value:$t.value.trades),cl=m(()=>ut.value.length===0&&Lt.value.length>0),yt=m(()=>{var s;if(ut.value.length>0){const t=Number((s=Tt.value)==null?void 0:s.total_realized_net);return Number.isFinite(t)?t:ut.value.reduce((l,u)=>l+(Number(u==null?void 0:u.net_pnl)||0),0)}return $t.value.trades.length?$t.value.totalNet:null});async function vl(s){try{n.value.loading=!0;const t={};s&&s!=="auto"&&(t.source=s);const u=(await Ft.get("/api/trading/live/status",{params:t})).data||{};n.value.enabled=!!u.enabled;const c=u.params||{};n.value.saving||(n.value.params.base_size=c.base_size??n.value.params.base_size??1,n.value.params.cooldown_sec=c.cooldown_sec??n.value.params.cooldown_sec??60,n.value.params.last_trade_ts=c.last_trade_ts??n.value.params.last_trade_ts??null,n.value.params.allow_scale_in=c.allow_scale_in??n.value.params.allow_scale_in??!1,n.value.params.scale_in_size_ratio=c.scale_in_size_ratio??n.value.params.scale_in_size_ratio??.5,n.value.params.scale_in_max_legs=c.scale_in_max_legs??n.value.params.scale_in_max_legs??3,n.value.params.scale_in_min_price_move=c.scale_in_min_price_move??n.value.params.scale_in_min_price_move??0,n.value.params.scale_in_cooldown_sec=c.scale_in_cooldown_sec??n.value.params.scale_in_cooldown_sec??0,Object.prototype.hasOwnProperty.call(c,"scale_in_freeze_on_exit")&&(n.value.params.scale_in_freeze_on_exit=!!c.scale_in_freeze_on_exit),Object.prototype.hasOwnProperty.call(c,"exit_slice_seconds")&&(n.value.params.exit_slice_seconds=Number(c.exit_slice_seconds||0)));const i=u.equity||{};n.value.equity.starting=i.starting??n.value.equity.starting??null,n.value.equity.current=i.current??n.value.equity.current??null,n.value.equity.peak=i.peak??n.value.equity.peak??null,n.value.equity.cumulative_pnl=i.cumulative_pnl??n.value.equity.cumulative_pnl??null;const _=Array.isArray(u.positions)?u.positions:[];n.value.positions.splice(0,n.value.positions.length,..._);const p=Array.isArray(u.orders)?u.orders:[];n.value.orders.splice(0,n.value.orders.length,...p),u&&typeof u.orders_source=="string"&&(n.value.ordersSource=u.orders_source==="exchange"?"exchange":"db"),Ct.value=Date.now()}catch{}finally{n.value.loading=!1}}const Jt=m(()=>{var u,c;const s=((u=n.value.params)==null?void 0:u.last_trade_ts)||0,t=((c=n.value.params)==null?void 0:c.cooldown_sec)||0;return!s||!t?0:Math.max(0,Math.ceil(s+t-Date.now()/1e3))}),Qt=m(()=>Xa()),ml=m(()=>{var l,u,c;const s=(c=(u=(l=o.value.data)==null?void 0:l.scale_in)==null?void 0:u.gates)==null?void 0:c.current_price,t=typeof s=="number"?s:Number(s);return Number.isFinite(t)?t:null}),Pt=m(()=>{const s=ml.value;if(s==null)return null;try{const t=Array.isArray(n.value.positions)?n.value.positions:[];let l=0;for(const u of t){const c=Number(u.entry_price),i=Number(u.size);Number.isFinite(c)&&Number.isFinite(i)&&(l+=(s-c)*i)}return l}catch{return null}}),Xt=m(()=>{const s=Number(n.value.equity.starting),t=Number(n.value.equity.current);return!Number.isFinite(s)||!Number.isFinite(t)||s===0?null:(t/s-1)*100}),Zt=m(()=>{const s=Number(n.value.equity.peak),t=Number(n.value.equity.current);return!Number.isFinite(s)||!Number.isFinite(t)||s===0?null:(t/s-1)*100}),Bt=m(()=>{const s=Number(n.value.equity.cumulative_pnl);return Number.isFinite(s)?s:null}),kt=(s,t=2)=>s==null?"-":`${s.toFixed(t)}%`,te=(s,t=2)=>s==null?"-":s.toFixed(t),xl=m(()=>E.value==="backtest"?kt(ee.value):kt(Xt.value)),_l=m(()=>{const s=E.value==="backtest"?ee.value:Xt.value;return s==null?"idle":s>=0?"ok":"error"}),pl=m(()=>E.value==="backtest"?kt(se.value):kt(Zt.value)),bl=m(()=>{const s=E.value==="backtest"?se.value:Zt.value;return s==null?"idle":s<=-10?"warning":"ok"}),gl=m(()=>E.value==="backtest"?yt.value==null?"-":yt.value.toFixed(2):te(Bt.value)),fl=m(()=>E.value==="backtest"?yt.value==null?"idle":yt.value>=0?"ok":"error":Bt.value==null?"idle":Bt.value>=0?"ok":"error"),hl=m(()=>E.value==="backtest"?"-":te(Pt.value)),yl=m(()=>E.value==="backtest"||Pt.value==null?"idle":Pt.value>=0?"ok":"error"),ee=m(()=>{try{const s=Lt.value;if(!Array.isArray(s))return null;const t=Number(mt.value||0);if(!isFinite(t)||t<=0)return null;const l=s.reduce((u,c)=>u+(Number(c==null?void 0:c.net_pnl)||0),0);return(t+l)/t*100-100}catch{return null}}),se=m(()=>{try{const s=Lt.value;if(!Array.isArray(s))return null;const t=Number(mt.value||0);if(!isFinite(t)||t<=0)return null;let l=t,u=t,c=0;for(const i of s){l+=Number(i==null?void 0:i.net_pnl)||0,l>u&&(u=l);const _=(l/u-1)*100;_<c&&(c=_)}return c}catch{return null}});function At(s){const t=new Date,l=new Date(t.getTime()-s*24*60*60*1e3);K.value=gt(l),G.value=gt(t),ht()}const kl=m(()=>{const s=W.value.data;if(!s)return!1;const t=Array.isArray(s.orders)?s.orders.length:0,l=Array.isArray(s.events)?s.events.length:0,u=Array.isArray(s.trades)?s.trades.length:0;return t===0&&l===0&&u===0}),wl=m(()=>{const s=Array.isArray(n.value.orders)?n.value.orders.slice():[];return s.sort((t,l)=>{const u=Number(t.filled_ts||t.filled_ts_ms||t.created_ts||t.created_ts_ms||0);return Number(l.filled_ts||l.filled_ts_ms||l.created_ts||l.created_ts_ms||0)-u}),s.slice(0,20)});function Nl(s){const t=Number(s.filled_ts||s.filled_ts_ms||s.created_ts||s.created_ts_ms||0);if(!Number.isFinite(t)||t<=0)return"-";const l=t>1e12?t:t*1e3;try{return new Date(l).toLocaleTimeString()}catch{return"-"}}return(s,t)=>{var l,u,c,i,_,p,f,C,x,h,k,T,F,w,P,R,tt,et,Y,dt,ct,Dt,D,j,ae,le,ne,re,oe,ie,ue,de,ce,ve,me,xe,_e,pe,be,ge,fe,he,ye,ke,we,Ne,Fe,Ce,Ee,Se,Me,Te,$e,Le,Pe,Be,Ae,De,Ie,ze,Oe,Re,qe,je,He,Ue,Ve,We,Ye,Ke,Ge,Je,Qe,Xe,Ze,ts,es,ss,as,ls,ns,rs,os,is,us,ds,cs,vs,ms,xs,_s,ps,bs,gs,fs,hs,ys,ks,ws,Ns,Fs,Cs,Es,Ss,Ms,Ts,$s,Ls,Ps,Bs,As,Ds,Is,zs,Os,Rs,qs,js,Hs,Us,Vs,Ws,Ys,Ks,Gs,Js,Qs,Xs,Zs,ta,ea,sa,aa,la,na,ra,oa,ia,ua,da,ca,va,ma,xa,_a,pa,ba,ga,fa,ha,ya,ka,wa,Na,Fa,Ca,Ea,Sa,Ma,Ta,$a,La,Pa,Ba,Aa,Da;return d(),v("div",Al,[t[113]||(t[113]=e("div",{class:"px-3 py-2 text-[11px] rounded border border-neutral-700 bg-neutral-800/40 text-neutral-300"},[e("details",null,[e("summary",{class:"cursor-pointer"},"도움말"),e("div",{class:"mt-1 space-y-1"},[e("div",null,"• 요약: 자동 새로고침은 백엔드 간격을 따릅니다. 수동 갱신 시 활동 요약과 라이브/백테스트 블록이 함께 갱신됩니다."),e("div",null,"• 신뢰 구간 운영: 기준(thr) 대비 prob 차이(margin)와 히스테리시스 Δ(pp)로 경계 구간 on/off 흔들림을 완화합니다."),e("div",null,"• 성과: Live(실거래) 또는 Backtest(리플레이)를 선택할 수 있습니다. 백엔드 트레이드가 없으면 이벤트 기반 합성 거래로 대체합니다."),e("div",null,"• 캘리브레이션: ECE/Brier/ΔECE, Wilson 95% CI, ECE 기여도%/누적%로 우선순위를 확인하세요."),e("a",{class:"underline text-[11px] text-brand-accent",href:"/docs/ko_ops_guide.md",target:"_blank",rel:"noopener"},"자세한 가이드 보기")])])],-1)),e("section",Dl,[e("div",Il,[t[22]||(t[22]=e("h1",{class:"text-xl font-semibold flex items-center gap-2"}," 트레이딩 ",-1)),e("div",zl,[e("button",{class:"btn btn-xs",onClick:_t,disabled:wt(O).refreshing},"갱신",8,Ol),wt(O).refreshing?(d(),v("span",Rl)):b("",!0),e("label",ql,[I(e("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=r=>vt.value=r),class:"accent-brand-primary"},null,512),[[Sl,vt.value]]),t[21]||(t[21]=N(" 자동 새로고침 ",-1))]),(l=S.value)!=null&&l.interval?(d(),v("span",jl,"loop "+a(S.value.interval)+"s",1)):b("",!0)])]),Rt.value?(d(),v("div",{key:0,class:z(["mb-3 text-[11px] px-2 py-1 rounded border",Ja.value?"border-neutral-700 bg-neutral-800/40 text-neutral-300":"border-amber-500/30 bg-amber-500/10 text-amber-200"])},a(Rt.value),3)):b("",!0),wt(O).initialLoading&&!S.value?(d(),v("div",Hl,"불러오는 중...")):!S.value&&!wt(O).refreshing?(d(),v("div",Ul,"요약 데이터 없음")):(d(),v("div",Vl,[e("div",Wl,[t[23]||(t[23]=e("span",{class:"text-sm font-semibold"},"Trading Activity",-1)),$(U,{status:(u=S.value)!=null&&u.auto_loop_enabled?"ok":"idle"},{default:H(()=>{var r;return[N(a((r=S.value)!=null&&r.auto_loop_enabled?"자동":"수동"),1)]}),_:1},8,["status"]),I($(U,{status:"warning"},{default:H(()=>[N("비활성: "+a(qt.value),1)]),_:1},512),[[Nt,qt.value]]),Ct.value?(d(),v("span",Yl,"갱신 "+a(new Date(Ct.value).toLocaleTimeString()),1)):b("",!0)]),e("div",Kl,[$(V,{label:"최근 결정 시각",value:ja.value,status:Ha.value},null,8,["value","status"]),$(V,{label:"1분 결정 수",value:((c=S.value)==null?void 0:c.decisions_1m)??"-",status:Ua.value},null,8,["value","status"]),$(V,{label:"5분 결정 수",value:((i=S.value)==null?void 0:i.decisions_5m)??"-",status:Va.value},null,8,["value","status"]),$(V,{label:"연속 유휴",value:Wa.value,status:Ya.value},null,8,["value","status"]),$(V,{label:"자동 루프",value:(_=S.value)!=null&&_.auto_loop_enabled?"on":"off",status:(p=S.value)!=null&&p.auto_loop_enabled?"ok":"idle"},null,8,["value","status"]),$(V,{label:"활동 상태",value:Ka.value,status:Ga.value},null,8,["value","status"])])])),I(e("details",Gl,[t[24]||(t[24]=e("summary",{class:"cursor-pointer"},"raw summary JSON",-1)),e("pre",null,a(S.value),1)],512),[[Nt,S.value]])]),e("section",Jl,[e("div",Ql,[e("div",Xl,[e("div",Zl,[t[26]||(t[26]=e("div",{class:"text-sm font-semibold"},"Live Trading",-1)),$(U,{status:n.value.enabled?"ok":"idle"},{default:H(()=>[N(a(n.value.enabled?"자동 주문 실행":"비활성"),1)]),_:1},8,["status"]),n.value.params.allow_scale_in?(d(),Ia(U,{key:0,status:"ok"},{default:H(()=>[...t[25]||(t[25]=[N("추가 매수 ON",-1)])]),_:1})):b("",!0)]),Et.value?(d(),v("div",tn,"수수료 "+a(Et.value),1)):b("",!0)]),e("div",en,[e("label",sn,[e("input",{type:"checkbox",class:"accent-brand-primary",checked:n.value.enabled,onChange:t[1]||(t[1]=r=>tl(r))},null,40,an),t[27]||(t[27]=N(" 자동 주문 실행",-1))]),e("button",{disabled:n.value.loading,onClick:_t,class:"px-3 py-1.5 rounded bg-brand-accent text-neutral-900 dark:text-white font-medium hover:opacity-90 disabled:opacity-50"},"Refresh",8,ln)])]),e("div",nn,[n.value.params.last_trade_ts?(d(),v("span",rn,"last trade "+a(new Date(n.value.params.last_trade_ts*1e3).toLocaleTimeString()),1)):b("",!0),Jt.value>0?(d(),v("span",on,"쿨다운 "+a(Jt.value)+"s 남음",1)):b("",!0)]),(f=o.value.data)!=null&&f.scale_in?(d(),v("div",un,[e("div",dn,[e("div",cn,[t[28]||(t[28]=e("div",{class:"font-medium"},"추가매수 진단",-1)),(x=(C=o.value.data)==null?void 0:C.scale_in)!=null&&x.allow?(d(),v("span",vn,"ON")):(d(),v("span",mn,"OFF")),e("span",xn,"gate: "+a((((T=(k=(h=o.value.data)==null?void 0:h.scale_in)==null?void 0:k.gates)==null?void 0:T.gate_mode)||"or").toUpperCase()),1)]),$(U,{status:(w=(F=o.value.data)==null?void 0:F.scale_in)!=null&&w.ready?"ok":"idle"},{default:H(()=>{var r,M;return[N(a((M=(r=o.value.data)==null?void 0:r.scale_in)!=null&&M.ready?"Ready":"Blocked"),1)]}),_:1},8,["status"])]),e("div",_n,[e("div",pn,[t[35]||(t[35]=e("div",{class:"text-neutral-400 mb-1"},"게이트",-1)),e("div",bn,[t[29]||(t[29]=e("div",{class:"text-neutral-400"},"가격 게이트",-1)),e("div",{class:z((tt=(R=(P=o.value.data)==null?void 0:P.scale_in)==null?void 0:R.gates)!=null&&tt.gate_price_ok?"text-emerald-300 text-right":"text-rose-300 text-right")},a((dt=(Y=(et=o.value.data)==null?void 0:et.scale_in)==null?void 0:Y.gates)!=null&&dt.gate_price_ok?"OK":"BLOCK"),3),t[30]||(t[30]=e("div",{class:"text-neutral-400"},"Δ(권고) 게이트",-1)),e("div",{class:z((D=(Dt=(ct=o.value.data)==null?void 0:ct.scale_in)==null?void 0:Dt.gates)!=null&&D.gate_prob_ok?"text-emerald-300 text-right":"text-rose-300 text-right")},a((le=(ae=(j=o.value.data)==null?void 0:j.scale_in)==null?void 0:ae.gates)!=null&&le.gate_prob_ok?"OK":"BLOCK"),3)]),e("div",gn,[t[31]||(t[31]=e("div",null,"min_drop",-1)),e("div",fn,a((((re=(ne=o.value.data)==null?void 0:ne.scale_in)==null?void 0:re.min_price_move)??0).toFixed?o.value.data.scale_in.min_price_move.toFixed(3):((ie=(oe=o.value.data)==null?void 0:oe.scale_in)==null?void 0:ie.min_price_move)??"-"),1),t[32]||(t[32]=e("div",null,"price_drop",-1)),e("div",hn,a((((ce=(de=(ue=o.value.data)==null?void 0:ue.scale_in)==null?void 0:de.gates)==null?void 0:ce.price_drop)??null)==null?"-":(o.value.data.scale_in.gates.price_drop*100).toFixed(2)+"%"),1),t[33]||(t[33]=e("div",null,"Δ 요구",-1)),e("div",yn,a((((me=(ve=o.value.data)==null?void 0:ve.scale_in)==null?void 0:me.prob_delta_gate)??0).toFixed?o.value.data.scale_in.prob_delta_gate.toFixed(3):((_e=(xe=o.value.data)==null?void 0:xe.scale_in)==null?void 0:_e.prob_delta_gate)??"-"),1),t[34]||(t[34]=e("div",null,"Δ 현재",-1)),e("div",kn,a((((be=(pe=o.value.data)==null?void 0:pe.scale_in)==null?void 0:be.delta)??null)==null?"-":((fe=(ge=o.value.data.scale_in.delta).toFixed)==null?void 0:fe.call(ge,3))??o.value.data.scale_in.delta),1)])]),e("div",wn,[t[39]||(t[39]=e("div",{class:"text-neutral-400 mb-1"},"가격",-1)),e("div",Nn,[t[36]||(t[36]=e("div",{class:"text-neutral-400"},"현재",-1)),e("div",Fn,a(((Ne=(we=Number(((ke=(ye=(he=o.value.data)==null?void 0:he.scale_in)==null?void 0:ye.gates)==null?void 0:ke.current_price)??NaN)).toFixed)==null?void 0:Ne.call(we,4))??"-"),1),t[37]||(t[37]=e("div",{class:"text-neutral-400"},"엔트리",-1)),e("div",Cn,a(((Me=(Se=Number(((Ee=(Ce=(Fe=o.value.data)==null?void 0:Fe.scale_in)==null?void 0:Ce.gates)==null?void 0:Ee.entry_price)??NaN)).toFixed)==null?void 0:Me.call(Se,4))??"-"),1),t[38]||(t[38]=e("div",{class:"text-neutral-400"},"앵커",-1)),e("div",En,a(((Be=(Pe=Number(((Le=($e=(Te=o.value.data)==null?void 0:Te.scale_in)==null?void 0:$e.gates)==null?void 0:Le.anchor_price)??NaN)).toFixed)==null?void 0:Be.call(Pe,4))??"-"),1)])]),e("div",Sn,[t[43]||(t[43]=e("div",{class:"text-neutral-400 mb-1"},"상태",-1)),e("div",Mn,[t[40]||(t[40]=e("div",{class:"text-neutral-400"},"레그",-1)),e("div",Tn,a(((Ie=(De=(Ae=o.value.data)==null?void 0:Ae.scale_in)==null?void 0:De.state)==null?void 0:Ie.legs_used)??0)+"/"+a(((Oe=(ze=o.value.data)==null?void 0:ze.scale_in)==null?void 0:Oe.max_legs)??0),1),t[41]||(t[41]=e("div",{class:"text-neutral-400"},"쿨다운",-1)),e("div",$n,a(((je=(qe=(Re=o.value.data)==null?void 0:Re.scale_in)==null?void 0:qe.state)==null?void 0:je.cooldown_remaining)??0)+"s",1),t[42]||(t[42]=e("div",{class:"text-neutral-400"},"포지션",-1)),e("div",Ln,a(((We=(Ve=Number(((Ue=(He=o.value.data)==null?void 0:He.scale_in)==null?void 0:Ue.position_size)??0)).toFixed)==null?void 0:We.call(Ve,4))??"-"),1)]),e("div",Pn,"활성 게이트: "+a((((Ge=(Ke=(Ye=o.value.data)==null?void 0:Ye.scale_in)==null?void 0:Ke.gates)==null?void 0:Ge.active_gates)||[]).join(", ")||"-"),1)])]),Array.isArray((Qe=(Je=o.value.data)==null?void 0:Je.scale_in)==null?void 0:Qe.blocked_reasons)&&o.value.data.scale_in.blocked_reasons.length?(d(),v("div",Bn,[(d(!0),v(st,null,at(o.value.data.scale_in.blocked_reasons,(r,M)=>(d(),v("span",{key:M,class:"px-1 py-0.5 rounded border border-amber-700/50 bg-amber-900/20 text-amber-200 text-[10px]"},a(r),1))),128))])):b("",!0)])):b("",!0),(Xe=o.value.data)!=null&&Xe.exit?(d(),v("div",An,[e("div",Dn,[t[44]||(t[44]=e("div",{class:"flex items-center gap-2"},[e("div",{class:"font-medium"},"청산 진단")],-1)),$(U,{status:(ts=(Ze=o.value.data)==null?void 0:Ze.exit)!=null&&ts.ready?"ok":"idle"},{default:H(()=>{var r,M;return[N(a((M=(r=o.value.data)==null?void 0:r.exit)!=null&&M.ready?"Ready":"Blocked"),1)]}),_:1},8,["status"])]),e("div",In,[e("div",zn,[t[49]||(t[49]=e("div",{class:"text-neutral-400 mb-1"},"결정 기반",-1)),e("div",On,[t[45]||(t[45]=e("div",{class:"text-neutral-400"},"의사결정",-1)),e("div",{class:z((ls=(as=(ss=(es=o.value.data)==null?void 0:es.exit)==null?void 0:ss.triggers)==null?void 0:as.decision)!=null&&ls.decision_ok?"text-emerald-300 text-right":"text-rose-300 text-right")},a((is=(os=(rs=(ns=o.value.data)==null?void 0:ns.exit)==null?void 0:rs.triggers)==null?void 0:os.decision)!=null&&is.decision_ok?"EXIT/FLAT":"HOLD"),3),t[46]||(t[46]=e("div",{class:"text-neutral-400"},"순익 요건",-1)),e("div",{class:z((vs=(cs=(ds=(us=o.value.data)==null?void 0:us.exit)==null?void 0:ds.triggers)==null?void 0:cs.decision)!=null&&vs.net_profit_ok?"text-emerald-300 text-right":"text-rose-300 text-right")},a((ps=(_s=(xs=(ms=o.value.data)==null?void 0:ms.exit)==null?void 0:xs.triggers)==null?void 0:_s.decision)!=null&&ps.net_profit_ok?"OK":"NOT YET"),3),t[47]||(t[47]=e("div",{class:"text-neutral-400"},"쿨다운",-1)),e("div",{class:z((hs=(fs=(gs=(bs=o.value.data)==null?void 0:bs.exit)==null?void 0:gs.triggers)==null?void 0:fs.decision)!=null&&hs.cooldown_ok?"text-emerald-300 text-right":"text-rose-300 text-right")},a((Ns=(ws=(ks=(ys=o.value.data)==null?void 0:ys.exit)==null?void 0:ks.triggers)==null?void 0:ws.decision)!=null&&Ns.cooldown_ok?"OK":(((Ss=(Es=(Cs=(Fs=o.value.data)==null?void 0:Fs.exit)==null?void 0:Cs.triggers)==null?void 0:Es.decision)==null?void 0:Ss.cooldown_remaining)??0)+"s"),3),t[48]||(t[48]=e("div",{class:"text-neutral-400"},"손익분기까지",-1)),e("div",Rn,a(((Ls=($s=(Ts=(Ms=o.value.data)==null?void 0:Ms.exit)==null?void 0:Ts.triggers)==null?void 0:$s.decision)==null?void 0:Ls.price_to_breakeven)==null?"-":((Bs=(Ps=o.value.data.exit.triggers.decision.price_to_breakeven).toFixed)==null?void 0:Bs.call(Ps,4))??o.value.data.exit.triggers.decision.price_to_breakeven),1)]),e("div",qn,"ready: "+a((zs=(Is=(Ds=(As=o.value.data)==null?void 0:As.exit)==null?void 0:Ds.triggers)==null?void 0:Is.decision)!=null&&zs.ready?"yes":"no"),1)]),e("div",jn,[t[53]||(t[53]=e("div",{class:"text-neutral-400 mb-1"},"트레일링",-1)),e("div",Hn,[t[50]||(t[50]=e("div",{class:"text-neutral-400"},"설정",-1)),e("div",Un,a(Math.floor((((js=(qs=(Rs=(Os=o.value.data)==null?void 0:Os.exit)==null?void 0:Rs.triggers)==null?void 0:qs.trailing)==null?void 0:js.trailing_pct)??0)*100))+"%",1),t[51]||(t[51]=e("div",{class:"text-neutral-400"},"풀백",-1)),e("div",Vn,a((((Ws=(Vs=(Us=(Hs=o.value.data)==null?void 0:Hs.exit)==null?void 0:Us.triggers)==null?void 0:Vs.trailing)==null?void 0:Ws.pullback)??null)==null?"-":(((Ks=(Ys=o.value.data.exit.triggers.trailing.pullback*100).toFixed)==null?void 0:Ks.call(Ys,2))??"-")+"%"),1),t[52]||(t[52]=e("div",{class:"text-neutral-400"},"남은 풀백",-1)),e("div",Wn,a((((Xs=(Qs=(Js=(Gs=o.value.data)==null?void 0:Gs.exit)==null?void 0:Js.triggers)==null?void 0:Qs.trailing)==null?void 0:Xs.remaining)??null)==null?"-":(((ta=(Zs=o.value.data.exit.triggers.trailing.remaining*100).toFixed)==null?void 0:ta.call(Zs,2))??"-")+"%"),1)]),e("div",Yn,"ready: "+a((la=(aa=(sa=(ea=o.value.data)==null?void 0:ea.exit)==null?void 0:sa.triggers)==null?void 0:aa.trailing)!=null&&la.ready?"yes":"no"),1)]),e("div",Kn,[t[57]||(t[57]=e("div",{class:"text-neutral-400 mb-1"},"최대 보유",-1)),e("div",Gn,[t[54]||(t[54]=e("div",{class:"text-neutral-400"},"허용",-1)),e("div",Jn,a(((ia=(oa=(ra=(na=o.value.data)==null?void 0:na.exit)==null?void 0:ra.triggers)==null?void 0:oa.max_hold)==null?void 0:ia.max_hold_sec)??0)+"s",1),t[55]||(t[55]=e("div",{class:"text-neutral-400"},"경과",-1)),e("div",Qn,a(((va=(ca=(da=(ua=o.value.data)==null?void 0:ua.exit)==null?void 0:da.triggers)==null?void 0:ca.max_hold)==null?void 0:va.age_sec)??"-")+"s",1),t[56]||(t[56]=e("div",{class:"text-neutral-400"},"남은 시간",-1)),e("div",Xn,a(((pa=(_a=(xa=(ma=o.value.data)==null?void 0:ma.exit)==null?void 0:xa.triggers)==null?void 0:_a.max_hold)==null?void 0:pa.remaining_sec)??"-")+"s",1)]),e("div",Zn,"ready: "+a((ha=(fa=(ga=(ba=o.value.data)==null?void 0:ba.exit)==null?void 0:ga.triggers)==null?void 0:fa.max_hold)!=null&&ha.ready?"yes":"no"),1)])]),Array.isArray((ka=(ya=o.value.data)==null?void 0:ya.exit)==null?void 0:ka.blocked_reasons)&&o.value.data.exit.blocked_reasons.length?(d(),v("div",tr,[(d(!0),v(st,null,at(o.value.data.exit.blocked_reasons,(r,M)=>(d(),v("span",{key:M,class:"px-1 py-0.5 rounded border border-amber-700/50 bg-amber-900/20 text-amber-200 text-[10px]"},a(r),1))),128))])):b("",!0)])):b("",!0),e("div",er,[e("div",sr,[t[60]||(t[60]=e("div",{class:"text-neutral-400"},"Parameters",-1)),e("div",ar,[e("label",lr,[t[58]||(t[58]=e("span",{class:"w-20 text-neutral-500"},"base size",-1)),I(e("input",{class:"input w-full text-neutral-100 placeholder-neutral-500",type:"number",step:"0.0001",min:"0","onUpdate:modelValue":t[2]||(t[2]=r=>n.value.params.base_size=r)},null,512),[[lt,n.value.params.base_size,void 0,{number:!0}]])]),e("label",nr,[t[59]||(t[59]=e("span",{class:"w-20 text-neutral-500"},"cooldown",-1)),I(e("input",{class:"input w-full text-neutral-100 placeholder-neutral-500",type:"number",min:"0","onUpdate:modelValue":t[3]||(t[3]=r=>n.value.params.cooldown_sec=r)},null,512),[[lt,n.value.params.cooldown_sec,void 0,{number:!0}]])])])]),e("div",rr,[t[73]||(t[73]=e("div",{class:"text-neutral-400"},"신뢰 구간 운영",-1)),e("div",or,[t[62]||(t[62]=e("div",{class:"text-[10px] text-neutral-500"},"실행은 라이브, 기준은 프로덕션 · 라이브는 미리보기/감시",-1)),e("label",ir,[t[61]||(t[61]=N(" hysteresis Δ(pp): ",-1)),I(e("input",{class:"input input-xxs w-20",type:"number",step:"0.005",min:"0",max:"0.2","onUpdate:modelValue":t[4]||(t[4]=r=>it.value=r)},null,512),[[lt,it.value,void 0,{number:!0}]])])]),e("div",ur,[e("div",dr,[e("div",cr,[t[64]||(t[64]=e("div",{class:"font-medium"},"운영 기준",-1)),$(U,{status:"ok"},{default:H(()=>[...t[63]||(t[63]=[N("프로덕션 기준(실거래)",-1)])]),_:1})]),e("div",vr,[e("div",null,[t[65]||(t[65]=N("thr ",-1)),e("span",mr,a(((wa=q.value)==null?void 0:wa.toFixed(3))??"-"),1)]),(Na=o.value.data)!=null&&Na.threshold_override?(d(),v("div",xr,"override 적용됨")):b("",!0)])]),e("div",_r,[e("div",pr,[t[66]||(t[66]=e("div",{class:"font-medium"},"라이브 미리보기",-1)),$(U,{status:al.value},{default:H(()=>[N(a(sl.value),1)]),_:1},8,["status"])]),e("div",br,[e("div",null,[t[67]||(t[67]=N("prob ",-1)),e("span",gr,a(((Fa=rt.value)==null?void 0:Fa.toFixed(3))??"-"),1)]),e("div",null,[t[68]||(t[68]=N("thr ",-1)),e("span",fr,a(((Ca=q.value)==null?void 0:Ca.toFixed(3))??"-"),1)]),e("div",null,[t[69]||(t[69]=N("margin ",-1)),e("span",{class:z(nl.value)},a(ll.value),3)])]),St.value?(d(),v("div",hr,"경계 구간: 잦은 on/off 예방에 유의")):b("",!0),(Ea=o.value.data)!=null&&Ea.inference_symbol_mismatch?(d(),v("div",yr,"심볼/피드 불일치 감지")):b("",!0)])]),e("div",kr,[Ut.value?(d(),v("div",wr,[t[70]||(t[70]=N(" symbol: ",-1)),e("span",Nr,a(Ut.value),1)])):b("",!0),e("table",Fr,[t[72]||(t[72]=e("thead",{class:"text-neutral-400"},[e("tr",null,[e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"기준"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"thr"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"override"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"thr_in"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"thr_out"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"추가매수 비율"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"최대 레그"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"추가매수 쿨다운(s)"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"최소 가격 이동"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"수수료")])],-1)),e("tbody",null,[e("tr",null,[t[71]||(t[71]=e("td",{class:"p-1 text-neutral-300"},"프로덕션",-1)),e("td",Cr,a(((Sa=q.value)==null?void 0:Sa.toFixed(3))??"-"),1),e("td",Er,a(((Ma=o.value.data)==null?void 0:Ma.threshold_override)!=null?(($a=(Ta=o.value.data.threshold_override).toFixed)==null?void 0:$a.call(Ta,3))??o.value.data.threshold_override:"-"),1),e("td",Sr,a(rl.value),1),e("td",Mr,a(ol.value),1),e("td",Tr,a(il.value),1),e("td",$r,a(((La=n.value.params)==null?void 0:La.scale_in_max_legs)??"-"),1),e("td",Lr,a(((Pa=n.value.params)==null?void 0:Pa.scale_in_cooldown_sec)??"-"),1),e("td",Pr,a(((Ba=n.value.params)==null?void 0:Ba.scale_in_min_price_move)??"-"),1),e("td",Br,a(Et.value),1)])])])])]),e("div",Ar,[e("div",Dr,[e("div",Ir,[t[74]||(t[74]=e("div",{class:"text-neutral-400"},"Performance",-1)),$(U,{status:E.value==="live"?"ok":"idle",title:"Live: 실거래 지표 / Backtest: 리플레이 요약"},{default:H(()=>[N("Data Source: "+a(E.value==="live"?"Live":"Backtest"),1)]),_:1},8,["status"])]),e("label",zr,[t[76]||(t[76]=N(" Source: ",-1)),I(e("select",{"onUpdate:modelValue":t[5]||(t[5]=r=>E.value=r),class:"input input-xs bg-neutral-900 text-neutral-200"},[...t[75]||(t[75]=[e("option",{value:"live"},"Live (Exchange)",-1),e("option",{value:"backtest"},"Backtest (Replay)",-1)])],512),[[Ml,E.value]])])]),E.value==="backtest"?(d(),v("div",Or,[e("label",Rr,[t[77]||(t[77]=e("span",{class:"w-20 text-neutral-500"},"From",-1)),I(e("input",{class:"input w-full",type:"datetime-local","onUpdate:modelValue":t[6]||(t[6]=r=>K.value=r),onChange:ht},null,544),[[lt,K.value]])]),e("label",qr,[t[78]||(t[78]=e("span",{class:"w-20 text-neutral-500"},"To",-1)),I(e("input",{class:"input w-full",type:"datetime-local","onUpdate:modelValue":t[7]||(t[7]=r=>G.value=r),onChange:ht},null,544),[[lt,G.value]])]),e("label",jr,[t[79]||(t[79]=e("span",{class:"w-24 text-neutral-500"},"Start Equity",-1)),I(e("input",{class:"input w-full",type:"number",min:"0",step:"1","onUpdate:modelValue":t[8]||(t[8]=r=>mt.value=r)},null,512),[[lt,mt.value,void 0,{number:!0}]])]),e("label",Hr,[t[80]||(t[80]=e("span",{class:"w-16 text-neutral-500"},"Symbol",-1)),I(e("input",{class:"input w-full",type:"text",placeholder:"e.g. BTCUSDT","onUpdate:modelValue":t[9]||(t[9]=r=>xt.value=r),onChange:ht},null,544),[[lt,xt.value]])]),e("div",Ur,[t[81]||(t[81]=e("span",null,"Preset:",-1)),e("button",{class:"btn btn-xxs",onClick:t[10]||(t[10]=r=>At(7))},"7D"),e("button",{class:"btn btn-xxs",onClick:t[11]||(t[11]=r=>At(30))},"30D"),e("button",{class:"btn btn-xxs",onClick:t[12]||(t[12]=r=>At(90))},"90D")])])):b("",!0),e("div",Vr,[$(V,{label:"ROI",value:xl.value,status:_l.value},null,8,["value","status"]),$(V,{label:"누적 PnL",value:gl.value,status:fl.value},null,8,["value","status"]),$(V,{label:"최대 낙폭",value:pl.value,status:bl.value},null,8,["value","status"]),$(V,{label:"미실현 PnL",value:hl.value,status:yl.value},null,8,["value","status"])]),E.value==="backtest"?(d(),v("div",Wr,[Kt.value||Gt.value?(d(),v("span",Yr,"window: "+a(Kt.value||"-")+" → "+a(Gt.value||"-"),1)):b("",!0),kl.value?(d(),v("span",Kr,"선택 기간에 체결 주문/트레이드가 없습니다")):cl.value?(d(),v("span",Gr,"백엔드 트레이드 없음 → 이벤트로 재구성한 성과 사용")):b("",!0)])):b("",!0),E.value==="backtest"&&W.value.data?(d(),v("details",Jr,[t[82]||(t[82]=e("summary",{class:"cursor-pointer"},"backtest raw JSON",-1)),e("pre",null,a(W.value.data),1)])):b("",!0)])]),Qt.value?(d(),v("div",Qr,a(Qt.value),1)):b("",!0),I(e("details",Xr,[t[83]||(t[83]=e("summary",{class:"cursor-pointer"},"no-signal breakdown",-1)),e("pre",null,a(o.value.data),1)],512),[[Nt,o.value.data]]),e("div",Zr,[e("div",to,[e("div",eo,[t[84]||(t[84]=e("div",{class:"font-medium"},"Positions",-1)),(Aa=n.value.positions)!=null&&Aa.length?(d(),v("div",so,a(n.value.positions.length)+"개",1)):b("",!0)]),!n.value.positions||n.value.positions.length===0?(d(),v("div",ao,"포지션 없음")):(d(),v("table",lo,[t[85]||(t[85]=e("thead",{class:"text-neutral-400"},[e("tr",null,[e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"심볼"),e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60"},"수량"),e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60"},"평단")])],-1)),e("tbody",null,[(d(!0),v(st,null,at(n.value.positions,(r,M)=>(d(),v("tr",{key:M},[e("td",no,a(r.symbol),1),e("td",ro,a(Number(r.size).toFixed(4)),1),e("td",oo,a(Number(r.entry_price).toFixed(4)),1)]))),128))])]))]),e("div",io,[e("div",uo,[t[86]||(t[86]=e("div",{class:"font-medium"},"Orders",-1)),e("div",co,[(Da=n.value.orders)!=null&&Da.length?(d(),v("span",vo,a(n.value.orders.length)+"개",1)):b("",!0),n.value.ordersSource?(d(),v("span",mo,a(n.value.ordersSource),1)):b("",!0)])]),!n.value.orders||n.value.orders.length===0?(d(),v("div",xo,"주문 없음")):(d(),v("table",_o,[t[87]||(t[87]=e("thead",{class:"text-neutral-400"},[e("tr",null,[e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"시간"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"심볼"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"사이드"),e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60"},"수량"),e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60"},"가격"),e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60"},"상태")])],-1)),e("tbody",null,[(d(!0),v(st,null,at(wl.value,(r,M)=>(d(),v("tr",{key:M},[e("td",po,a(Nl(r)),1),e("td",bo,a(r.symbol),1),e("td",{class:z(["p-1",r.side==="buy"?"text-emerald-300":"text-rose-300"])},a(r.side),3),e("td",go,a(Number(r.size).toFixed(4)),1),e("td",fo,a(Number(r.price).toFixed(4)),1),e("td",ho,a(r.status),1)]))),128))])])),n.value.orders&&n.value.orders.length>20?(d(),v("div",yo,"최근 20개만 표시")):b("",!0)])])]),g.value.show?(d(),v("section",ko,[e("div",wo,[e("div",No,[t[88]||(t[88]=e("div",{class:"text-sm font-semibold"},"라이브 vs 프로덕션",-1)),g.value.sampleCount!=null?(d(),v("span",{key:0,class:z(["px-1.5 py-0.5 rounded border text-[10px]",ul.value])},"N="+a(g.value.sampleCount),3)):b("",!0)]),e("div",Fo,[g.value.winFrom||g.value.winTo?(d(),v("div",Co," window(UTC): "+a(g.value.winFrom||"-")+" → "+a(g.value.winTo||"-"),1)):b("",!0),e("button",{class:"btn btn-xxs",onClick:dl},"Copy report"),e("button",{class:"btn btn-xxs",onClick:t[13]||(t[13]=r=>nt.value=!nt.value)},a(nt.value?"접기":"펼치기"),1)])]),I(e("div",null,[e("div",Eo,[e("div",So,[e("div",Mo,[t[89]||(t[89]=e("div",{class:"text-neutral-400",title:"낮을수록 좋음"},"프로덕션 ECE (↓)",-1)),e("div",To,a(g.value.prodECE),1),t[90]||(t[90]=e("div",{class:"text-neutral-400",title:"낮을수록 좋음"},"라이브 ECE (↓)",-1)),e("div",{class:z(["text-neutral-200 text-right",g.value.eceWorse?"text-rose-300":"text-emerald-300"])},a(g.value.liveECE),3),t[91]||(t[91]=e("div",{class:"text-neutral-400"},"Δ ECE",-1)),e("div",{class:z(["text-neutral-200 text-right",g.value.eceWorse?"text-rose-300":"text-emerald-300"])},a(g.value.deltaECE),3),t[92]||(t[92]=e("div",{class:"text-neutral-400",title:"낮을수록 좋음"},"Live Brier (↓)",-1)),e("div",$o,a(g.value.liveBrier),1),t[93]||(t[93]=e("div",{class:"text-neutral-400",title:"낮을수록 좋음"},"Prod Brier (↓)",-1)),e("div",Lo,a(g.value.prodBrier),1)]),e("div",Po,[e("div",{class:"h-full bg-emerald-500/70",style:za({width:g.value.liveECEBarWidth})},null,4)]),t[94]||(t[94]=e("div",{class:"mt-1 text-[10px] text-neutral-500"},"막대 = 라이브 ECE (0~0.2 스케일 제한)",-1))]),e("div",Bo,[e("div",Ao,[t[96]||(t[96]=e("div",{class:"font-medium"},"모니터",-1)),g.value.retrainRecommended?(d(),Ia(U,{key:0,status:"warning"},{default:H(()=>[...t[95]||(t[95]=[N("재학습 추천",-1)])]),_:1})):b("",!0)]),e("div",Do,[e("div",Io,[t[97]||(t[97]=e("div",{class:"text-neutral-400"},"절대 편차 연속",-1)),e("div",zo,a(g.value.absStreak??"-"),1)]),e("div",Oo,[t[98]||(t[98]=e("div",{class:"text-neutral-400"},"상대 편차 연속",-1)),e("div",Ro,a(g.value.relStreak??"-"),1)])]),e("div",qo,[e("div",{class:"h-full bg-rose-500/70",style:za({width:g.value.deltaBarWidth})},null,4)]),g.value.reasons&&g.value.reasons.length?(d(),v("ul",jo,[(d(!0),v(st,null,at(g.value.reasons,(r,M)=>(d(),v("li",{key:M},a(r),1))),128))])):b("",!0),e("div",Ho,"샘플수: "+a(g.value.sampleCount??"-"),1)]),t[112]||(t[112]=Tl('<div class="p-2 rounded border border-neutral-700/60 bg-neutral-800/30" data-v-f18ce965><div class="flex items-center justify-between mb-2" data-v-f18ce965><div class="font-medium" data-v-f18ce965>상위 드리프트 Z</div><div class="text-neutral-500" data-v-f18ce965>드리프트</div></div><div class="text-[10px] text-neutral-500" data-v-f18ce965>데이터 없음</div></div>',1)),e("div",Uo,[t[99]||(t[99]=e("div",{class:"flex items-center justify-between mb-2"},[e("div",{class:"font-medium"},"리라이어빌리티 플롯"),e("div",{class:"text-[10px] text-neutral-500"},"점 크기=N, 색상=격차(|conf−acc|)")],-1)),e("div",Vo,[(d(),v("svg",{width:It,height:zt,viewBox:`0 0 ${It} ${zt}`,class:"block"},[e("defs",null,[e("clipPath",{id:"relClip"},[e("rect",{x:y,y,width:Z,height:A,rx:"2",ry:"2"})])]),e("line",{x1:y,y1:y,x2:y,y2:y+A,stroke:"#404040","stroke-width":"1"},null,8,Yo),e("line",{x1:y,y1:y+A,x2:y+Z,y2:y+A,stroke:"#404040","stroke-width":"1"},null,8,Ko),e("line",{x1:y,y1:y+A,x2:y+Z,y2:y,stroke:"#6b7280","stroke-dasharray":"3,3","stroke-width":"1"},null,8,Go),e("g",Jo,[e("text",{x:y-6,y:y+A+4,"text-anchor":"end"},"0.0",8,Qo),e("text",{x:y-6,y:y+A/2+3,"text-anchor":"end"},"0.5",8,Xo),e("text",{x:y-6,y:y+3,"text-anchor":"end"},"1.0",8,Zo),e("text",{x:y,y:y+A+12,"text-anchor":"middle"},"0.0",8,ti),e("text",{x:y+Z/2,y:y+A+12,"text-anchor":"middle"},"0.5",8,ei),e("text",{x:y+Z,y:y+A+12,"text-anchor":"middle"},"1.0",8,si)]),e("g",ai,[(d(!0),v(st,null,at(Yt.value,(r,M)=>(d(),v("circle",{key:M,cx:y+r.x*Z,cy:y+(1-r.y)*A,r:r.r,fill:r.color,"fill-opacity":"0.9"},[e("title",null,a(r.title),1)],8,li))),128))]),e("g",ni,[e("text",{x:y+Z/2,y:y+A+22,"text-anchor":"middle"},"conf",8,ri),e("text",{x:y-12,y:y+A/2,"text-anchor":"middle",transform:"rotate(-90, \\n                    ${relPad-12}, ${relPad+relInnerH/2})"},"acc",8,oi)])],8,Wo))]),Yt.value.length?b("",!0):(d(),v("div",ii,"데이터 없음"))]),e("div",ui,[t[110]||(t[110]=e("div",{class:"flex items-center justify-between mb-2"},[e("div",{class:"font-medium"},"신뢰 구간(Bin) 브레이크다운"),e("div",{class:"text-[10px] text-neutral-500"},"기여도 = (N/N전체)·|conf−acc| · CI=Wilson 95%")],-1)),e("div",di,[e("table",ci,[e("thead",vi,[e("tr",null,[e("th",{class:"text-left font-medium p-1 border-b border-neutral-700/60 cursor-pointer select-none",title:"예측 확률 범위(예: 0.6–0.7)",onClick:t[14]||(t[14]=r=>X("range"))},[t[100]||(t[100]=N(" 구간 ",-1)),Q("range")?(d(),v("span",mi,a(B.value==="asc"?"▲":"▼"),1)):b("",!0)]),e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60 cursor-pointer select-none",title:"예측 확률의 평균",onClick:t[15]||(t[15]=r=>X("conf"))},[t[101]||(t[101]=N(" 평균(conf) ",-1)),Q("conf")?(d(),v("span",xi,a(B.value==="asc"?"▲":"▼"),1)):b("",!0)]),e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60 cursor-pointer select-none",title:"실제 정답 비율",onClick:t[16]||(t[16]=r=>X("acc"))},[t[102]||(t[102]=N(" 경험(acc) ",-1)),Q("acc")?(d(),v("span",_i,a(B.value==="asc"?"▲":"▼"),1)):b("",!0)]),e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60 cursor-pointer select-none",title:"정확(acc)의 95% 윌슨 신뢰구간 폭",onClick:t[17]||(t[17]=r=>X("ciw"))},[t[103]||(t[103]=N(" CI(95%) ",-1)),Q("ciw")?(d(),v("span",pi,a(B.value==="asc"?"▲":"▼"),1)):b("",!0)]),e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60 cursor-pointer select-none",title:"|conf−acc|, 보정 필요 크기",onClick:t[18]||(t[18]=r=>X("gap"))},[t[104]||(t[104]=N(" 격차 ",-1)),Q("gap")?(d(),v("span",bi,a(B.value==="asc"?"▲":"▼"),1)):b("",!0)]),e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60 cursor-pointer select-none",title:"표본 수",onClick:t[19]||(t[19]=r=>X("n"))},[t[105]||(t[105]=N(" N ",-1)),Q("n")?(d(),v("span",gi,a(B.value==="asc"?"▲":"▼"),1)):b("",!0)]),e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60 cursor-pointer select-none",title:"(N/N전체)×|conf−acc|",onClick:t[20]||(t[20]=r=>X("contrib"))},[t[106]||(t[106]=N(" 기여도(ECE) ",-1)),Q("contrib")?(d(),v("span",fi,a(B.value==="asc"?"▲":"▼"),1)):b("",!0)]),t[107]||(t[107]=e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60"},"기여도%",-1)),t[108]||(t[108]=e("th",{class:"text-right font-medium p-1 border-b border-neutral-700/60"},"누적%",-1))])]),e("tbody",null,[(d(!0),v(st,null,at(Wt.value,(r,M)=>(d(),v("tr",{key:M,class:z(r.n<20?"opacity-60":"")},[e("td",hi,a(r.range),1),e("td",yi,a(r.conf.toFixed(3)),1),e("td",ki,a(r.acc.toFixed(3)),1),e("td",wi,a(r.ciLow==null?"-":r.ciLow.toFixed(3))+"–"+a(r.ciHigh==null?"-":r.ciHigh.toFixed(3)),1),e("td",{class:z(["p-1 text-right",r.gap>.05?"text-rose-300":"text-neutral-200"])},a(r.gap.toFixed(3)),3),e("td",Ni,a(r.n),1),e("td",Fi,a(r.contrib.toFixed(4)),1),e("td",Ci,a(r.contribPct==null?"-":(r.contribPct*100).toFixed(1))+"%",1),e("td",Ei,a(r.cumPct==null?"-":(r.cumPct*100).toFixed(1))+"%",1)],2))),128)),Wt.value.length?b("",!0):(d(),v("tr",Si,[...t[109]||(t[109]=[e("td",{class:"p-2 text-neutral-500",colspan:"9"},"데이터 없음",-1)])]))])])]),t[111]||(t[111]=e("div",{class:"mt-1 text-[10px] text-neutral-500"}," 안내: 컬럼 헤더를 클릭하면 정렬됩니다. 기여도(ECE)=(N/N전체)×|conf−acc|, CI는 Wilson 95%입니다. 기여도%는 각 bin의 ECE 비율, 누적%는 현재 정렬 기준 상단부터의 누적 비율입니다. ",-1))])])],512),[[Nt,nt.value]])])):b("",!0)])}}}),Di=Bl(Ti,[["__scopeId","data-v-f18ce965"]]);export{Di as default};
